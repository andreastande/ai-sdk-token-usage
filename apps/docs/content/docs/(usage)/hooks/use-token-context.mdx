---
title: useTokenContext
---

<Callout type="warn" title="Message metadata required">
  In order to use the hooks, the required metadata-fields for AI SDK Token Usage has to be attached to the message.
  If you have not done this, read [Message Metadata](/docs/message-metadata).
</Callout>

The hook `useTokenContext` can be used to get insight into how much of the context window is remaining.

It provides several convenient, pre-computed values such as the remaining and used tokens, percentage used, a boolean to determine
if the context window is exceeded and more! These values are derived directly from the message metadata and the model’s defined 
context window, allowing you to easily visualize or enforce token limits in your UI.

This is particularly useful when building chat interfaces or tools that need to display usage progress, disable 
input when nearing the limit, or warn users about potential truncation.

## Usage

`useTokenContext` is simple to use, and needs only the messages in the chat + the canonical slug for the currently selected model.

```tsx
import { useTokenContext } from 'ai-sdk-token-usage';
import { useChat } from '@ai-sdk/react';

const canonicalSlug = 'openai/gpt-5'; // the canonical slug for the model used

export default function Chat() {
  const { messages } = useChat();

  const context = useTokenContext(messages, canonicalSlug); // [!code highlight]
};
```

<Callout>A canonical slug is a string composed of the provider and model id, split by a slash /. Needed for correct look-up in model registry.</Callout>

Here, `context` is an object with three keys:

1. **data**: All data related to token context.
2. **isLoading**: A boolean used to determine if data is loading or not.
3. **error**: If an error occured, this will hold useful information to either debug the issue or display an appropriate message to the user.

The reasoning behind this data structure is that the hook leverages SWR internally for data fetching, which introduces asynchronous behavior. 
SWR returns an object containing data, error, and isLoading, and useTokenContext follows the same pattern. 
This makes it intuitive for developers familiar with SWR or React Query to handle loading states, manage errors gracefully, and access the resolved
data once available — ensuring a consistent and predictable experience when working with asynchronous hooks.

Read the [API signature](#api-signature) to understand the full structure of the hook’s inputs and return values, and how each field can be 
used in your component.

---

## API Signature

### Parameters

import { TypeTable } from 'fumadocs-ui/components/type-table';

<TypeTable
  type={{
    messages: {
      description: <p>The messages in your chat, returned from <strong>useChat</strong>.</p>,
      type: 'UIMessage[]',
      required: true
    },
    canonicalSlug: {
      description: (
        <div>
          <p>A unique identifier for the model used. Composed by provider and model id, split by a slash /.</p>
          <p><strong>Example: </strong>"openai/gpt-5".</p>
        </div>
      ),
      type: 'string',
      required: true
    }
  }}
/>

### Returns

<TypeTable
  type={{
    data: {
      description: (
        <div>
          <p>An object with all data related to token context.</p>
          <TypeTable
            type={{
              breakdown: {
                description: (
                  <div>
                    <p>A breakdown of where the tokens in the context reside.</p>
                    <TypeTable
                      type={{
                        input: {
                          description: 'Input tokens.',
                          type: 'number',
                          required: true
                        },
                        output: {
                          description: 'Output tokens.',
                          type: 'number',
                          required: true
                        },
                        reasoning: {
                          description: 'Reasoning tokens.',
                          type: 'number',
                          required: true
                        },
                        cachedInput: {
                          description: 'Cached input tokens.',
                          type: 'number',
                          required: true
                        }
                      }}
                    />
                  </div>
                ),
                type: 'Breakdown',
                required: true
              },
              used: {
                description: 'Amount of tokens used.',
                type: 'number',
                required: true
              },
              limit: {
                description: 'Context window of the model.',
                type: 'number',
                required: true
              },
              remaining: {
                description: 'Amount of tokens remaining in context window.',
                type: 'number',
                required: true
              },
              fractionUsed: {
                description: 'Fraction of context window used.',
                type: 'number',
                required: true
              },
              percentageUsed: {
                description: 'Percentage of context window used.',
                type: 'number',
                required: true
              },
              isExceeded: {
                description: 'A boolean to determine if context window is exceeded or not.',
                type: 'boolean',
                required: true
              },
            }}
          />
        </div>
      ),
      type: 'Context | undefined',
      required: true
    },
    isLoading: {
      description: 'A boolean to determine if data is loading or not.',
      type: 'boolean',
      required: true
    },
    error: {
      description: (
        <div>
          <p>An object containing detailed information about the error.</p>
          <TypeTable
            type={{
              name: {
                description: 'The name of the error (e.g. "FetchError" or "MissingMetadataError").',
                type: 'string',
                required: true
              },
              message: {
                description:
                  'A human-readable message that describes what went wrong and how to resolve it.',
                type: 'string',
                required: true
              },
              status: {
                description: 'The HTTP-style status code associated with the error.',
                type: 'number',
                required: true
              },
              info: {
                description:
                  'Additional contextual information about the cause of the error. Useful for debugging and advanced handling.',
                type: 'unknown',
                required: true
              }
            }}
          />
        </div>
      ),
      type: 'TokenUsageError | null',
      required: true
    }
  }}
/>